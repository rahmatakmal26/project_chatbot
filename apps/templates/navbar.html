{% load static %}
<link rel="stylesheet" href="{% static 'css/navbar.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<nav class="navbar">
    <div class="menu-toggle" onclick="toggleMenu()">â˜°</div>

    <div class="logo">Layanan TIF</div>

    <ul class="nav-links">
        <li><a href="{% url 'dashboard' %}" class="{% if request.path == '/dashboard/' %}active{% endif %}">Beranda</a></li>
        <li><a href="{% url 'layanan' %}" class="{% if request.path == '/layanan/' %}active{% endif %}">Layanan</a></li>
        <li><a href="{% url 'berita' %}" class="{% if request.path == '/berita/' %}active{% endif %}">Berita</a></li>
    </ul>

    <div class="user-info dropdown">
        <span id="user-icon" onclick="toggleDropdown()"><i class="fas fa-user"></i></span>
        <ul class="dropdown-menu" id="user-dropdown">
            <li><span id="user-email">Memuat...</span></li>
            <li><a href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
        </ul>
    </div>
</nav>


<script>
    function toggleMenu() {
        var menu = document.querySelector(".nav-links");
        menu.classList.toggle("show");
    }

    function toggleDropdown() {
        document.querySelector(".user-info").classList.toggle("show");
    }


    document.addEventListener("click", function (e) {
        const userInfo = document.querySelector(".user-info");
        if (!userInfo.contains(e.target)) {
            userInfo.classList.remove("show");
        }
    });


    document.addEventListener("DOMContentLoaded", function () {
    const emailSpan = document.getElementById("user-email");

    fetch("/get-email/")
        .then(response => response.json())
        .then(data => {
            emailSpan.textContent = data.email || "Anonymous";
        })
        .catch(error => {
            console.error("Error fetching user info:", error);
        });


    const navLinks = document.querySelectorAll(".nav-links a");
    const navMenu = document.querySelector(".nav-links");

    navLinks.forEach(link => {
        link.addEventListener("click", function () {
            if (window.innerWidth <= 768) {
                navMenu.classList.remove("show");
            }
        });
    });
});

</script>
